[include moonraker_obico_macros.cfg]
# This file contains pin mappings for the Creality Ender 5 Plus with a BTT Octopus Pro.

# See docs/Config_Reference.md for a description of parameters.

[include mainsail.cfg]
[include macros.cfg]
[include Adaptive_Mesh.cfg]
[include Line_Purge.cfg]
[include tmc2209.cfg]
[include fans.cfg]
[include extruder.cfg]
[include chameleonMacros.cfg]
[include notifications.cfg]

[stepper_x]
step_pin: PF13
dir_pin: !PF12
enable_pin: !PF14
microsteps: 16
rotation_distance: 40
endstop_pin: PG6
position_endstop: 365
position_max: 365
homing_speed: 100

[stepper_y]
step_pin: PG0
dir_pin: !PG1
enable_pin: !PF15
microsteps: 16
rotation_distance: 40
endstop_pin: PG9
position_endstop: 365
position_max: 365
homing_speed: 100

[stepper_z1]
step_pin: PF11
dir_pin: !PG3
enable_pin: !PG5
microsteps: 16
rotation_distance: 4

[stepper_z]
step_pin: PG4
dir_pin: !PC1
enable_pin: !PA0
microsteps: 16
rotation_distance: 4
endstop_pin: probe:z_virtual_endstop
#endstop_pin: PG12
#position_endstop: 0
position_max: 400
position_min: -5
homing_speed: 10.0

[z_tilt]
z_positions: -40,200
  400,200
points: 0,200
  300,200
speed: 150
horizontal_move_z: 5
retries: 10
retry_tolerance: 0.02

[safe_z_home]
#home_xy_position: 329.60, 372
home_xy_position: 175, 175
speed: 100
z_hop: 10
z_hop_speed: 5

[bltouch]
sensor_pin: ^PB7
control_pin: PB6
x_offset: 56
y_offset: -24
#z_offset: 2
speed: 3.0
stow_on_each_sample: false
probe_with_touch_mode: true
#pin_up_touch_mode_reports_triggered: False

[bed_mesh]
speed: 200
horizontal_move_z: 5
mesh_min: 56, 0
mesh_max: 360, 340
#probe_count: 5,5
probe_count: 21, 21
algorithm: bicubic
bicubic_tension: 0.2
mesh_pps: 10,10
fade_start:1
fade_end:3

[heater_bed]
heater_pin: PB11 #HE3
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PF7
control: pid
pid_Kp: 690.34
pid_Ki: 111.47
pid_Kd: 1068.83
min_temp: 0
max_temp: 130

[temperature_sensor RPi]
sensor_type: temperature_host

[mcu]
#serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_26002900105053424E363620-if00
#serial: /dev/serial/by-path/platform-fd500000.pcie-pci-0000:01:00.0-usb-0:1.3:1.0
#serial: /dev/serial/by-path/platform-fd500000.pcie-pci-0000:01:00.0-usb-0:1.1:1.0
serial: /dev/serial/by-path/platform-fd500000.pcie-pci-0000:01:00.0-usb-0:1.2:1.0

#[mcu adxl]
#serial: /dev/serial/by-path/platform-fd500000.pcie-pci-0000:01:00.0-usb-0:1.4:1.0

#[adxl345]
#cs_pin: adxl:gpio9
#spi_software_sclk_pin: adxl:gpio10
#spi_software_mosi_pin: adxl:gpio11
#spi_software_miso_pin: adxl:gpio12

#[resonance_tester]
#accel_chip: adxl345
#probe_points:
#    175, 175, 200

[printer]
kinematics: cartesian
max_velocity: 500
#max_accel: 4000 #can run here, but no reason to for now
max_accel: 2000 #run here for now
max_z_velocity: 15
max_z_accel: 150

[endstop_phase]

[respond]

[force_move]
enable_force_move: true
#   Set to true to enable FORCE_MOVE and SET_KINEMATIC_POSITION
#   extended G-Code commands. The default is false.

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -0.492718, -0.460218, -0.400218, -0.323968, -0.273968, -0.253968, -0.231468, -0.205218, -0.133968, -0.130218, -0.126468, -0.143968, -0.126468, -0.108968, -0.135218, -0.168968, -0.200218, -0.188968, -0.206468, -0.225218, -0.251468
#*# 	  -0.441468, -0.413968, -0.365218, -0.305218, -0.250218, -0.223968, -0.198968, -0.185218, -0.132718, -0.115218, -0.101468, -0.140218, -0.121468, -0.103968, -0.125218, -0.156468, -0.170218, -0.167718, -0.188968, -0.226468, -0.248968
#*# 	  -0.367718, -0.340218, -0.292718, -0.232718, -0.185218, -0.155218, -0.148968, -0.127718, -0.066468, -0.077718, -0.083968, -0.085218, -0.072718, -0.067718, -0.077718, -0.106468, -0.130218, -0.130218, -0.155218, -0.195218, -0.225218
#*# 	  -0.242718, -0.255218, -0.207718, -0.151468, -0.102718, -0.087718, -0.081468, -0.057718, -0.007718, -0.017718, -0.020218, -0.028968, -0.013968, -0.001468, -0.013968, -0.037718, -0.065218, -0.070218, -0.093968, -0.136468, -0.160218
#*# 	  -0.235218, -0.203968, -0.163968, -0.097718, -0.055218, -0.035218, -0.021468, -0.003968, 0.038532, 0.029782, 0.018532, 0.001032, 0.017282, 0.027282, 0.011032, -0.013968, -0.006468, -0.020218, -0.043968, -0.082718, -0.117718
#*# 	  -0.183968, -0.151468, -0.112718, -0.056468, -0.018968, -0.007718, 0.007282, 0.013532, 0.067282, 0.069782, 0.064782, 0.057282, 0.063532, 0.069782, 0.049782, 0.011032, -0.013968, -0.007718, -0.028968, -0.065218, -0.105218
#*# 	  -0.141468, -0.118968, -0.080218, -0.025218, -0.000218, 0.014782, 0.027282, 0.043532, 0.112282, 0.096032, 0.092282, 0.067282, 0.079782, 0.074782, 0.059782, 0.018532, -0.001468, 0.001032, -0.018968, -0.053968, -0.088968
#*# 	  -0.107718, -0.072718, -0.036468, 0.011032, 0.057282, 0.074782, 0.083532, 0.098532, 0.158532, 0.147282, 0.144782, 0.117282, 0.119782, 0.119782, 0.098532, 0.063532, 0.042282, 0.043532, 0.023532, -0.015218, -0.066468
#*# 	  -0.071468, -0.036468, 0.002282, 0.052282, 0.083532, 0.087282, 0.082282, 0.101032, 0.151032, 0.142282, 0.143532, 0.123532, 0.132282, 0.147282, 0.124782, 0.102282, 0.071032, 0.068532, 0.039782, -0.011468, -0.050218
#*# 	  -0.042718, -0.008968, 0.034782, 0.092282, 0.138532, 0.151032, 0.138532, 0.151032, 0.178532, 0.176032, 0.162282, 0.148532, 0.156032, 0.168532, 0.154782, 0.138532, 0.117282, 0.122282, 0.094782, 0.039782, -0.012718
#*# 	  -0.008968, 0.007282, 0.046032, 0.097282, 0.141032, 0.149782, 0.174782, 0.158532, 0.207282, 0.189782, 0.173532, 0.154782, 0.159782, 0.162282, 0.148532, 0.121032, 0.103532, 0.109782, 0.093532, 0.053532, 0.017282
#*# 	  0.021032, 0.042282, 0.078532, 0.122282, 0.153532, 0.163532, 0.154782, 0.173532, 0.236032, 0.216032, 0.214782, 0.187282, 0.199782, 0.198532, 0.179782, 0.147282, 0.126032, 0.116032, 0.099782, 0.068532, 0.027282
#*# 	  0.037282, 0.066032, 0.086032, 0.139782, 0.161032, 0.171032, 0.161032, 0.168532, 0.214782, 0.202282, 0.206032, 0.189782, 0.199782, 0.196032, 0.176032, 0.144782, 0.113532, 0.111032, 0.087282, 0.057282, 0.023532
#*# 	  0.017282, 0.066032, 0.104782, 0.154782, 0.184782, 0.196032, 0.197282, 0.202282, 0.268532, 0.219782, 0.198532, 0.183532, 0.179782, 0.189782, 0.179782, 0.152282, 0.139782, 0.142282, 0.118532, 0.071032, 0.012282
#*# 	  0.036032, 0.063532, 0.103532, 0.154782, 0.181032, 0.188532, 0.188532, 0.218532, 0.226032, 0.213532, 0.199782, 0.177282, 0.181032, 0.183532, 0.173532, 0.136032, 0.114782, 0.126032, 0.093532, 0.052282, 0.004782
#*# 	  0.066032, 0.092282, 0.124782, 0.156032, 0.174782, 0.188532, 0.163532, 0.174782, 0.221032, 0.219782, 0.213532, 0.191032, 0.204782, 0.208532, 0.184782, 0.146032, 0.116032, 0.119782, 0.093532, 0.058532, 0.002282
#*# 	  0.062282, 0.074782, 0.117282, 0.144782, 0.167282, 0.169782, 0.158532, 0.177282, 0.227282, 0.217282, 0.208532, 0.186032, 0.193532, 0.197282, 0.174782, 0.141032, 0.118532, 0.124782, 0.107282, 0.068532, 0.038532
#*# 	  0.041032, 0.068532, 0.101032, 0.143532, 0.179782, 0.189782, 0.178532, 0.181032, 0.221032, 0.197282, 0.183532, 0.163532, 0.176032, 0.181032, 0.177282, 0.151032, 0.144782, 0.158532, 0.147282, 0.107282, 0.063532
#*# 	  0.006032, 0.027282, 0.067282, 0.119782, 0.142282, 0.148532, 0.144782, 0.142282, 0.174782, 0.152282, 0.143532, 0.127282, 0.136032, 0.134782, 0.131032, 0.113532, 0.094782, 0.113532, 0.108532, 0.067282, 0.044782
#*# 	  -0.041468, -0.012718, 0.017282, 0.053532, 0.069782, 0.072282, 0.058532, 0.063532, 0.108532, 0.094782, 0.088532, 0.077282, 0.087282, 0.088532, 0.074782, 0.038532, 0.011032, 0.032282, 0.021032, -0.000218, -0.026468
#*# 	  -0.022718, -0.017718, 0.009782, 0.052282, 0.052282, 0.054782, 0.059782, 0.061032, 0.108532, 0.101032, 0.089782, 0.067282, 0.066032, 0.069782, 0.052282, 0.002282, 0.062282, -0.017718, -0.023968, -0.046468, -0.055218
#*# tension = 0.2
#*# min_x = 60.0
#*# algo = bicubic
#*# y_count = 21
#*# mesh_y_pps = 10
#*# min_y = 0.0
#*# x_count = 21
#*# max_y = 340.0
#*# mesh_x_pps = 10
#*# max_x = 360.0
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 32.370
#*# pid_ki = 5.395
#*# pid_kd = 48.554
#*#
#*# [bltouch]
#*# z_offset = 2.85
#*#
#*# [input_shaper]
#*# shaper_type_x = ei
#*# shaper_freq_x = 52.6
#*# shaper_type_y = ei
#*# shaper_freq_y = 62.0
